(()=>{"use strict";function e(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}const t=function(){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.injectHTML(),this.inputField=document.querySelector("#live-search-field"),this.headerSearchIcon=document.querySelector(".header-search-icon"),this.overlay=document.querySelector(".search-overlay"),this.closeIcon=document.querySelector(".close-live-search"),this.resultsArea=document.querySelector(".live-search-results"),this.loaderIcon=document.querySelector(".circle-loader"),this.typingWaitTimer,this.previousValue="",this.events()}var s,n;return s=t,(n=[{key:"events",value:function(){var e=this;this.inputField.addEventListener("keyup",(function(){e.keyPressHandler()})),this.closeIcon.addEventListener("click",(function(){e.closeOverlay()})),this.headerSearchIcon.addEventListener("click",(function(t){t.preventDefault(),e.openOverlay(),setTimeout((function(){return e.inputField.focus()}),100)}))}},{key:"showLoaderIcon",value:function(){this.loaderIcon.classList.add("circle-loader--visible")}},{key:"hideLoaderIcon",value:function(){this.loaderIcon.classList.remove("circle-loader--visible")}},{key:"showResultsArea",value:function(){this.resultsArea.classList.add("live-search-results--visible")}},{key:"hideResultsArea",value:function(){this.resultsArea.classList.remove("live-search-results--visible")}},{key:"renderResultsHTML",value:function(e){var t;if(e.length>0){var s=e.map((function(e){return'\n            <a href="/posts/'.concat(e._id,'" class="list-group-item list-group-item-action">\n              <img class="avatar-tiny" src="').concat(e.author.avatar,'"> <strong>').concat(e.title,'</strong>\n              <span class="text-muted small">by ').concat(e.author.username," on ").concat((t=e.createdDate,s=new Date(t),"".concat(s.getDate(),"/").concat(s.getMonth()+1,"/").concat(s.getFullYear(),"\n      ")),"</span>\n            </a>\n            ");var t,s})).join(""),n="".concat(e.length," ").concat(e.length<1?"item":"items"," found");t='\n      <div class="list-group shadow-sm">\n        <div class="list-group-item active"><strong>Search Results</strong> ('.concat(n,")</div>\n          ").concat(s,"\n        </div>\n      </div>\n    ")}else t='<p class="alert alert-danger text-center shadow-sm">Sorry, we could not find any results for that search</p>';this.resultsArea.innerHTML=t,this.hideLoaderIcon(),this.showResultsArea()}},{key:"sendRequest",value:function(){var e=this;fetch("/search",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({searchTerm:this.inputField.value})}).then((function(e){return e.json()})).then((function(t){e.renderResultsHTML(t)})).catch((function(e){return console.log}))}},{key:"keyPressHandler",value:function(){var e=this,t=this.inputField.value;""===t?(clearTimeout(this.typingWaitTimer),this.hideLoaderIcon(),this.hideResultsArea()):t!==this.previousValue&&(clearTimeout(this.typingWaitTimer),this.showLoaderIcon(),this.hideResultsArea(),this.typingWaitTimer=setTimeout((function(){return e.sendRequest()}),750)),this.previousValue=t}},{key:"closeOverlay",value:function(){this.overlay.classList.remove("search-overlay--visible")}},{key:"openOverlay",value:function(){this.overlay.classList.add("search-overlay--visible")}},{key:"injectHTML",value:function(){document.body.insertAdjacentHTML("beforeend",'\n    <div class="search-overlay">\n    <div class="search-overlay-top shadow-sm">\n      <div class="container container--narrow">\n        <label for="live-search-field" class="search-overlay-icon"><i class="fas fa-search"></i></label>\n        <input type="text" id="live-search-field" class="live-search-field" placeholder="What are you interested in?">\n        <span class="close-live-search"><i class="fas fa-times-circle"></i></span>\n      </div>\n    </div>\n\n    <div class="search-overlay-bottom">\n      <div class="container container--narrow py-3">\n        <div class="circle-loader"></div>\n        <div class="live-search-results">\n      </div>\n    </div>\n  </div>\n    ')}}])&&e(s.prototype,n),t}();document.body.querySelector(".header-search-icon")&&new t})();